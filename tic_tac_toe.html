<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tic-Tac-Toe with AI</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }
    body {
      background-color: #548687;
      text-align: center;
      font-family: Arial, sans-serif;
    }
    .container {
      height: 70vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .game {
      height: 60vmin;
      width: 60vmin;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 1.5vmin;
    }
    .box {
      height: 18vmin;
      width: 18vmin;
      border-radius: 1rem;
      border: none;
      box-shadow: 0 0 1rem rgba(0, 0, 0, 0.3);
      font-size: 8vmin;
      background-color: #ffffc7;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      user-select: none;
      color: #b0413e;
    }
    .box:hover {
      background-color: #fff7a9;
      box-shadow: 0 0 1.2rem rgba(176, 65, 62, 0.8);
    }
    #reset-btn {
      padding: 1rem;
      font-size: 1.25rem;
      background-color: #191913;
      color: #fff;
      border-radius: 1rem;
      border: none;
      transition: background-color 0.3s ease;
      margin-top: 1.5rem;
      cursor: pointer;
    }
    #reset-btn:hover {
      background-color: #333;
    }
    #msg {
      color: #ffffc7;
      font-size: 5vmin;
      margin-top: 1rem;
      min-height: 6vmin;
    }
  </style>
</head>
<body>
  <main>
    <h1>Tic Tac Toe with AI</h1>
    <div class="container">
      <div class="game">
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
        <button class="box"></button>
      </div>
    </div>
    <button id="reset-btn">Reset Game</button>
    <div id="msg"></div>
  </main>

  <script>
    const boxes = document.querySelectorAll(".box");
    const resetBtn = document.getElementById("reset-btn");
    const msg = document.getElementById("msg");

    let board = ["", "", "", "", "", "", "", "", ""]; // 1D board for easier AI
    let gameOver = false;

    function checkWinner(bd) {
      const winPatterns = [
        [0,1,2], [3,4,5], [6,7,8], // rows
        [0,3,6], [1,4,7], [2,5,8], // cols
        [0,4,8], [2,4,6]           // diagonals
      ];

      for (const pattern of winPatterns) {
        const [a, b, c] = pattern;
        if (bd[a] && bd[a] === bd[b] && bd[b] === bd[c]) {
          return bd[a];
        }
      }
      if (bd.every(cell => cell !== "")) {
        return "draw";
      }
      return null;
    }

    function makeMove(index, player) {
      board[index] = player;
      boxes[index].innerText = player;
      boxes[index].disabled = true;
    }

    function playerMove(index) {
      if (gameOver || board[index] !== "") return;

      makeMove(index, "X");
      const result = checkWinner(board);
      if (result) return endGame(result);

      // AI turn delayed for UX
      setTimeout(() => {
        aiMove();
        const aiResult = checkWinner(board);
        if (aiResult) endGame(aiResult);
      }, 500);
    }

    function aiMove() {
      let bestScore = -Infinity;
      let moveIndex = null;
      for (let i=0; i<board.length; i++) {
        if (board[i] === "") {
          board[i] = "O";
          let score = minimax(board, false);
          board[i] = "";
          if (score > bestScore) {
            bestScore = score;
            moveIndex = i;
          }
        }
      }
      if (moveIndex !== null) {
        makeMove(moveIndex, "O");
      }
    }

    function minimax(bd, isMaximizing) {
      const result = checkWinner(bd);
      if (result !== null) {
        if (result === "O") return 1;
        else if (result === "X") return -1;
        else return 0;
      }

      if (isMaximizing) {
        let bestScore = -Infinity;
        for (let i=0; i<bd.length; i++) {
          if (bd[i] === "") {
            bd[i] = "O";
            let score = minimax(bd, false);
            bd[i] = "";
            bestScore = Math.max(score, bestScore);
          }
        }
        return bestScore;
      } else {
        let bestScore = Infinity;
        for (let i=0; i<bd.length; i++) {
          if (bd[i] === "") {
            bd[i] = "X";
            let score = minimax(bd, true);
            bd[i] = "";
            bestScore = Math.min(score, bestScore);
          }
        }
        return bestScore;
      }
    }

    function endGame(result) {
      gameOver = true;
      if (result === "draw") {
        msg.innerText = "It's a draw!";
      } else {
        msg.innerText = `${result} wins!`;
      }
      // Disable all buttons
      boxes.forEach(box => box.disabled = true);
    }

    function resetGame() {
      board = ["", "", "", "", "", "", "", "", ""];
      gameOver = false;
      msg.innerText = "";
      boxes.forEach(box => {
        box.innerText = "";
        box.disabled = false;
      });
    }

    boxes.forEach((box, idx) => {
      box.addEventListener("click", () => playerMove(idx));
    });

    resetBtn.addEventListener("click", resetGame);

  </script>
</body>
</html>
